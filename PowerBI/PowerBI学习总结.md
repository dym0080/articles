PowerBI学习总结
=============
<!-- TOC -->

- [PowerBI 整体介绍](#powerbi-整体介绍)
    - [介绍](#介绍)
    - [Power BI 的组成部分](#power-bi-的组成部分)
    - [Power BI 中的工作流程](#power-bi-中的工作流程)
    - [Power BI 构建基块](#power-bi-构建基块)
- [Power BI Desktop](#power-bi-desktop)
    - [在 Power BI Desktop 中连接到数据源](#在-power-bi-desktop-中连接到数据源)
    - [使用 Power Query 编辑器清理和转换数据](#使用-power-query-编辑器清理和转换数据)
    - [在 Power BI 中创建视觉对象](#在-power-bi-中创建视觉对象)
    - [共享 Power BI 报表](#共享-power-bi-报表)
- [Power BI 服务](#power-bi-服务)
    - [比较 Power BI Desktop 和 Power BI 服务](#比较-power-bi-desktop-和-power-bi-服务)
    - [网关配置](#网关配置)
    - [数据建模](#数据建模)
- [DAX 简介](#dax-简介)
- [自定义列VS计算列](#自定义列vs计算列)
- [参考资料](#参考资料)

<!-- /TOC -->


## PowerBI 整体介绍
### 介绍
Microsoft Power BI 是一系列协同工作，将数据转化为交互式见解的软件服务、应用和连接器。 可以使用单个基本源（例如 Excel 工作簿）中的数据，或者从多个数据库和云源拉取数据，以创建复杂的数据集和报表。 Power BI 既可以满足简单的需求，也可以满足复杂的企业级全球业务需求。

![](/assets/powerbi/2019/PowerBI介绍.png)

### Power BI 的组成部分
Power BI 由名为 **Power BI Desktop** 的 Microsoft Windows 桌面应用程序、名为 **Power BI 服务**的联机 SaaS（软件即服务）以及在 Windows 手机和平板电脑上可用并且在 Apple iOS 和 Google Android 设备上也可用的**移动版 Power BI APP**组成。
![](/assets/powerbi/2019/PowerBI的组成部分.png)

### Power BI 中的工作流程

所有这些活动以及使用 Power BI 执行的所有分析通常都遵循一个通用流程。 Power BI 中活动的通用流程如下所示：

1. 将数据引入 Power BI Desktop，并创建报表。
2. 发布到 Power BI 服务，在其中可以创建新的可视化效果或生成仪表板。
3. 与他人（尤其是出差人员）共享仪表板。
4. 在 Power BI Mobile 应用中查看共享的仪表板和报表并与其交互。

### Power BI 构建基块

- **可视化效果**（数据的可视表示形式，有时简称为视觉对象）
- **数据集**        （Power BI 用来创建可视化效果的数据集合）
- **报表**          （数据集中跨一个或多个页面的视觉对象集合）
- **仪表板**        （基于报表生成的单页视觉对象集合）
- **磁贴**          （报表或仪表板中的单个可视化效果）

## Power BI Desktop
Power BI Desktop 是用于数据的连接、清除、建模可视化数据的工具，一般是给报表的设计人员使用。
可以从 [Web](http://go.microsoft.com/fwlink/?LinkID=521662) 下载 Power BI Desktop，也可以从 Windows 应用商店将 Power BI Desktop 安装为应用，还可以从 Power BI 服务下载它。

在 Power BI Desktop 中有三种视图：“报表”视图、“数据”视图和“关系”视图

![](/assets/powerbi/2019/PowerBI三视图.png)

其中“报表”视图包含五个主要区域：
1. 功能区：显示与报表和可视化效果关联的常见任务
2. “报表”视图或画布：可在其中创建和排列可视化效果
3. 底部的“页面”选项卡区域：用于选择或添加报表页
4. “可视化效果”窗格：可在其中更改可视化效果、自定义颜色或轴、应用筛选器、拖动字段，或执行其他操作
5. “字段”窗格：可在其中将查询元素和筛选器拖到“报表”视图，或拖到“可视化效果”窗格的“筛选器”区域
![](/assets/powerbi/2019/报表视图的五个区域介绍.png)


### 在 Power BI Desktop 中连接到数据源
在 Power BI Desktop 中，可以连接到各种数据源。 只需在功能区上选择“获取数据”，然后就会显示多个连接器选项。
![](/assets/powerbi/2019/获取数据.png)



### 使用 Power Query 编辑器清理和转换数据
使用 Microsoft Power BI Desktop 连接到数据源后，必须根据需要调整数据。 有时，调整表示通过某种方式转换数据，例如，重命名列或表、将文本更改为数字、删除行或将第一行设为标题。在数据调整时原始数据源不受影响。 只有数据的此特定视图会进行调整或塑型。

Power Query 编辑器加载并呈现该数据时，提供可由其执行的用于调整数据的分步指令。这些指定的步骤（例如重命名表、转换数据类型或删除列）由 Power Query 编辑器记录。 每当此查询连接到数据源时，都会执行这些步骤，因此数据始终以指定的方式塑型。

![](/assets/powerbi/2019/分步指令.png)

### 在 Power BI 中创建视觉对象



### 共享 Power BI 报表
从 Power BI Desktop 发布到 Power BI 服务。 在功能区上的“开始”选项卡中选择“发布”。发布后可以在Power BI 服务中进行各种形式的共享。

## Power BI 服务
Microsoft Power BI 服务有时也称为 Power BI 在线版或 app.powerbi.com。 Power BI 可帮助你及时掌握对你重要的信息。

大多数 Power BI 使用者获得 Power BI 服务的方式是 1）他们的公司购买许可证；2）管理员将这些许可证分配给像你这样的员工。

要开始使用，只需打开浏览器并输入“app.powerbi.com”即可。 第一次打开 Power BI 服务时，会看到如下图所示内容。
![](/assets/powerbi/2019/powerbi服务主界面.png)

### 比较 Power BI Desktop 和 Power BI 服务
在维恩图中比较 Power BI Desktop 和 Power BI 服务，中间的区域会显示两者如何重叠。 可以在 Power BI Desktop 或服务中执行某些任务。 但在维恩图的两侧，应用程序和服务各有其独特的功能。
![](/assets/powerbi/2019/PowerBI比较.png)

- Power BI Desktop”是完整的数据分析和报表创建工具。 在本地计算机上安装免费应用程序时，可以连接到许多不同的数据源，并将其（通常称为建模）组合到数据模型中。一般是给报表设计人员制作报表用，用于数据连接、清除、建模和可视化数据。（完全免费）

- “Power BI 服务”是一种基于云的在线服务，用于为团队和公司进行轻量级报表编辑和协作。 也可以连接到 Power BI 服务中的数据源，但建模不可以。在其中可以共享 Power BI Desktop 报表，使用户能够在Web、APP、PPT等方式查看这些报表。（需要收费，有免费试用版）

致力于商业智能项目的大多数报表设计器都使用“Power BI Desktop”创建报表，然后使用“Power BI 服务”与他人共享其报表。

### 网关配置
TODO

### 数据建模
若要创建不同数据源之间的逻辑连接，需创建一种关系。 数据源之间的关系使 Power BI 能够了解表与表之间的关系，还可以创建你自己的自定义计算并分配新度量值。以便你能创建有趣的视觉对象和报表

- **管理数据关系：** 在关系视图创建表与表之间的关系，关系有多对一 、一对一、多对多

- **创建计算列：** 在“建模”选项卡中，选择新建列。使用DAX语言创建自己想要的列。

- **创建计算度量值：** 从主页选项卡中选择新度量值

- **创建计算表：** 从“建模”选项卡选择新建表。

## DAX 简介
DAX 即数据分析表达式，DAX 是一种 函数语言。它是Excel Services中的Analysis Services，Power BI Desktop和Power Pivot中使用的公式表达式语言。DAX公式包括函数，运算符和值，用于对表格数据模型中相关表和列中的数据执行高级计算和查询。

> 基本上能用SQL实现的基本可以使用DAX实现，但是建议使用SQL和DAX相结合的方式实现，哪个方便用哪个。

DAX 主要的计算：
- 计算列
- 计算度量值
- 计算表
- 行过滤器

DAX 拥有许多可用于成形、组织或分析数据的函数。 这些函数可以分为以下几个类别：

- **日期和时间函数：** DAX中的这些函数类似于Microsoft Excel中的日期和时间函数。但是，DAX函数基于Microsoft SQL Server使用的日期时间数据类型。

- **时间智能功能：** 这些功能可帮助您创建使用内置日历和日期知识的计算。通过将时间和日期范围与聚合或计算结合使用，您可以在销售，库存等可比较的时间段内建立有意义的比较。

- **过滤器函数：** 这些函数可帮助您返回特定数据类型，在相关表中查找值，以及按相关值过滤。查找函数通过使用表和它们之间的关系来工作。过滤功能允许您操纵数据上下文以创建动态计算。

- **信息函数：** 这些函数查看作为另一个函数的参数提供的表或列，并告诉您该值是否与预期类型匹配。例如，如果引用的值包含错误，则ISERROR函数返回TRUE。

- **逻辑函数：** 这些函数返回有关表达式中值的信息。例如，TRUE函数可以让您知道要评估的表达式是否返回TRUE值。

- **数学和触发函数：** DAX中的数学函数类似于Excel的数学和三角函数。但是，t99 是 DAX函数使用的数值数据类型的一些差异。

- **父和子函数：** 这些数据分析表达式（DAX）函数可帮助用户管理在其数据模型中显示为父/子层次结构的数据。

- **统计函数：** 这些函数执行聚合。除了创建总和和平均值，或查找最小值和最大值之外，您还可以在聚合之前过滤列，或者根据相关表创建聚合。

- **文本函数：** 使用这些函数，您可以返回字符串的一部分，在字符串中搜索文本或连接字符串值。附加功能用于控制日期，时间和数字的格式。

- **其他函数：** 这些函数执行无法由大多数其他函数所属的任何类别定义的唯一操作。

## 自定义列VS计算列
|| 自定义列 | 计算列  |
|:-|-:| -:|
|发生阶段|在数据建模阶段   |在数据编辑查询阶段|
|使用语言|M语言           |DAX语言|
|是否在编辑查询中显示步骤|会|不会|


## 参考资料
- [微软PowerBI官网文档](https://docs.microsoft.com/zh-cn/power-bi/)
- [数据分析表达式（DAX）参考](https://docs.microsoft.com/zh-cn/dax)